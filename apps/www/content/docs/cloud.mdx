---
title: Cloud
description: Streamline cloud integration for seamless access and management of cloud-based resources.
docs:
  - route: /docs/components/cloud
    title: Cloud
---

<ComponentPreview name="cloud-demo" padding="md" />

## Features

Plate Cloud is the official Plate plugin and cloud service for image and attachment uploads, automatic server-side image resizing, and future Plate cloud services.

It supports:

- Drag and drop uploading of images and attachments
- Paste uploading of images and attachments
- Using a file picker for uploading images and attachment
- Drag resize of images with server-side image resizing which optimizes download speed
- Automatically delivers high DPI images to high DPI devices and normal sized images to everyone else

Your usage of Plate Cloud supports the development of Plate.

You can start by [getting a free Portive API key](https://admin.portive.com/).

## Installation

```bash
npm install @udecode/plate-cloud
```

## Usage

To use Plate Cloud, you will need to [get a free Portive API key](https://www.portive.com/).

To get the value to save to your database, use `editor.cloud.getSaveValue()`. This is required for Plate Cloud because of the asynchronous nature of uploads.

### Options

```tsx
/**
 * CloudPlugin options
 */
export type CloudPlugin = {
    /**
   * Options for connecting to the official Portive Cloud service
   *
   * Either `apiKey` or `authToken` must be provided
   */
  apiKey?: string | () => string | () => Promise<string>;
  authToken?: string | () => string | () => Promise<string>;
  apiOrigin?: string;
  /**
   * Only used for testing to prepopulate the current state of uploads
   */
  uploadStoreInitialValue?: Record<string, Upload>;
};

/**
 * CloudAttachmentPlugin options (none at the moment)
 */
export type CloudAttachmentPlugin = {};

/**
 * CloudImagePlugin options
 */

export type CloudImagePlugin = {
  /**
   * Choose a max width/height to display for when an image is first update.
   * The image is always uploaded at full size so this is not about the
   * stored resolution of the image.
   */
  maxInitialWidth?: number;
  maxInitialHeight?: number;
};
```

### `CloudPlugin`

An interface representing configuration options for a cloud-based plugin for managing and uploading files in the editor.

<APIParameters>
  <APIItem
    name="uploadStoreInitialValue"
    type="Record<string, Upload>"
    optional
  >
    Initial value for the upload store.
  </APIItem>
</APIParameters>

### `PlateCloudEditor`

A type representing a CloudEditor with the additional functionality provided by the Plate Editor.

### `FinishUploadsOptions`

A type representing options when finishing uploads.

<APIParameters>
  <APIItem name="maxTimeoutInMs" type="number" optional>
    The maximum timeout in milliseconds to wait before considering the uploads
    finished.
  </APIItem>
</APIParameters>

### `CloudEditorProps`

A type representing properties of a CloudEditor.

<APIParameters>
  <APIItem name="cloud" type="Object">
    A namespace containing cloud-related properties.
  </APIItem>
</APIParameters>

### `FileEventBase`

A type representing the base properties for a file event, regardless
of the type of file.

<APIParameters>
  <APIItem name="id" type="string">
    The unique identifier for the file.
  </APIItem>
  <APIItem name="file" type="File">
    The File object.
  </APIItem>
  <APIItem name="url" type="string">
    The URL where the file is located.
  </APIItem>
</APIParameters>

### `GenericFileEvent`

A type representing a file event for generic files, which extends
FileEventBase.

<APIParameters>
  <APIItem name="type" type="'generic'">
    Indicates that the file is of generic type.
  </APIItem>
</APIParameters>

### `ImageFileEvent`

A type representing a file event for image files, which extends FileEventBase.

<APIParameters>
  <APIItem name="type" type="'image'">
    Indicates that the file is an image.
  </APIItem>
  <APIItem name="width" type="number">
    The width of the image.
  </APIItem>
  <APIItem name="height" type="number">
    The height of the image.
  </APIItem>
</APIParameters>

### `FileEvent`

A type that could be either a GenericFileEvent or ImageFileEvent.

### `ProgressEvent`

A type representing a progress event during file upload.

<APIParameters>
  <APIItem name="sentBytes" type="number">
    The number of bytes that have been sent so far.
  </APIItem>
  <APIItem name="totalBytes" type="number">
    The total number of bytes to send.
  </APIItem>
</APIParameters>

### `ErrorEvent` A type representing an error event during file upload.

<APIParameters>
  <APIItem name="message" type="string">
    The error message.
  </APIItem>
</APIParameters>

### `SuccessEvent`

A type representing a successful file upload event.

<APIParameters>
  <APIItem name="url" type="string">
    The URL where the uploaded file is located.
  </APIItem>
</APIParameters>

### Source Code

- [Cloud Plugin](https://github.com/udecode/plate/blob/main/packages/cloud/src/cloud/createCloudPlugin.ts)
- [Cloud Attachment Plugin](https://github.com/udecode/plate/blob/main/packages/cloud/src/attachment/createCloudAttachmentPlugin.ts)
- [Cloud Image Plugin](https://github.com/udecode/plate/blob/main/packages/cloud/src/image/createCloudImagePlugin.ts)
- [packages/cloud](https://github.com/udecode/plate/tree/main/packages/cloud)

## API

[createCloudAttachmentPlugin.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fattachment%2FcreateCloudAttachmentPlugin.ts)

### TCloudAttachmentElement

[useCloudAttachmentElementState.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fattachment%2FuseCloudAttachmentElementState.ts)
[withCloudAttachment.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fattachment%2FwithCloudAttachment.ts)

[createCloudPlugin.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FcreateCloudPlugin.ts)
[getInProgressUploads.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FgetInProgressUploads.ts)
[withCloud.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FwithCloud.ts)
[getSaveValue.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FgetSaveValue.ts)
[onDropCloud.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2Fhandlers.ts)
[onPasteCloud.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2Fhandlers.ts)
[uploadFiles.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FuploadFiles.ts)
[finishUploads.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FfinishUploads.ts)
[generateSrcAndSrcSet.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fcloud%2FgenerateSrcAndSrcSet.ts)
[createCloudImagePlugin.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fimage%2FcreateCloudImagePlugin.ts)
[useCloudImageElementState.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fimage%2FuseCloudImageElementState.ts)
[withCloudImage.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fimage%2FwithCloudImage.ts)
[createUploadStore.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fupload%2FcreateUploadStore.ts)
[useUpload.ts](..%2F..%2F..%2F..%2Fpackages%2Fcloud%2Fsrc%2Fupload%2FuseUpload.ts)

```tsx
/**
 * Specifies just the `options` part of the CloudPlugin
 */
export type CloudPlugin = ClientOptions & {
  uploadStoreInitialValue?: Record<string, Upload>;
};

export type PlateCloudEditor<V extends Value = Value> = PlateEditor<V> &
  CloudEditorProps<V>;

export type CloudEditorProps<V extends Value = Value> = {
  cloud: {
    client: Client;
    uploadFiles: (msg: any) => void;
    uploadStore: ReturnType<typeof createUploadStore>;
    genericFileHandlers?: {
      onStart?: (e: FileEvent) => void;
      onProgress?: (e: FileEvent & ProgressEvent) => void;
      onError?: (e: FileEvent & ErrorEvent) => void;
      onSuccess?: (e: FileEvent & SuccessEvent) => void;
    };
    imageFileHandlers?: {
      onStart?: (e: ImageFileEvent) => void;
      onProgress?: (e: ImageFileEvent & ProgressEvent) => void;
      onError?: (e: ImageFileEvent & ErrorEvent) => void;
      onSuccess?: (e: ImageFileEvent & SuccessEvent) => void;
    };
    getSaveValue: () => V;
    finishUploads: (options?: { maxTimeoutInMs?: number }) => Promise<void>;
    // save: (options: { maxTimeoutInMs?: number }) => Promise<V>;
  };
};

export type CloudImagePlugin = {
  maxInitialWidth?: number;
  maxInitialHeight?: number;
  minResizeWidth?: number;
  maxResizeWidth?: number;
};

export type CloudImageEditorProps = {
  cloudImage: {
    maxInitialWidth: number;
    maxInitialHeight: number;
    minResizeWidth: number;
    maxResizeWidth: number;
  };
};

export type PlateCloudImageEditor<V extends Value = Value> = PlateEditor<V> &
  CloudImageEditorProps;

export interface TCloudImageElement extends TElement {
  url: string;
  bytes: number;
  width: number;
  height: number;
  maxWidth: number;
  maxHeight: number;
}
```
